/*
 * vb_defines.h
 *
 *  Created on: 4 Apr 2019
 *      Author: john
 */

#ifndef VB_DEFINES_H_
#define VB_DEFINES_H_


#include "dr_defines.h"
#include "drext.h"
#include "dr_api.h"

#include "taint_bunny.h"

typedef unsigned int VB_EV_VULN_OPT_t;
// No additional information
#define VB_EV_ERROR 0
#define VB_EV_DETECT_UAF 1
#define VB_EV_DETECT_HBO 2
#define VB_EV_DETECT_DF 4

/**
 * TODO: ADD more vulnerabilities.
 * Keep calm, it's just a prototype.
 */
typedef enum {
    VB_UAF_VULN, VB_HEAP_BO_VULN, VB_DOUBLE_FREE_VULN
} vb_vuln_type_t;

typedef void (*vb_handle_vuln_func_t)(vb_vuln_type_t type, void *vuln_info, ub_opnd_access_t *vuln_slot, void *user_data);

#endif /* VB_DEFINES_H_ */
