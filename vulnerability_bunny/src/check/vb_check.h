/*
 * pb_handlers.h
 *
 *  Created on: 5 Aug 2018
 *      Author: john
 */

#ifndef SRC_INSTRUMENTATION_HANDLERS_PB_HANDLERS_H_
#define SRC_INSTRUMENTATION_HANDLERS_PB_HANDLERS_H_

#include "../vb_private.h"
#include  "../detection/vb_detect.h"

void vb_standard_check(vb_context_t *vb_ctx, void *drcontext, instrlist_t *ilist,
        instr_t *where, size_t opnd_size, ub_opnd_access_t *base_slot,
        ub_opnd_access_t *addr_slot, vb_detection_func_t uaf_func,
        vb_detection_func_t hbo_func, reg_id_t scratch_reg1,
        reg_id_t scratch_reg2);

void vb_rep_check(vb_context_t *vb_ctx, size_t inc_size, bool inc_dst,
        bool inc_src, ub_opnd_field_t cnt_field, void *drcontext,
        instrlist_t *ilist, instr_t *where, reg_id_t scratch_reg,
        reg_id_t scratch_reg2, reg_id_t scratch_reg3);

#endif /* SRC_INSTRUMENTATION_HANDLERS_PB_HANDLERS_H_ */
