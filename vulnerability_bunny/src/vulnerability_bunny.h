/*
 * vulnerability_bunny.h
 *
 *  Created on: 21 Mar 2019
 *      Author: john
 */

#ifndef VULNERABILITY_BUNNY_H_
#define VULNERABILITY_BUNNY_H_

#include "vb_defines.h"

DR_EXPORT void vb_init(client_id_t client_id, vb_handle_vuln_func_t vuln_func,
        VB_EV_VULN_OPT_t vuln_options, void *user_data);

DR_EXPORT void vb_exit();

/*****************************************************************************
 * Getters
 */

DR_EXPORT uintptr_t vb_get_root_addr(void *vb_heap_ptr_opaque);

DR_EXPORT uintptr_t vb_get_end(void *vb_heap_ptr_opaque);

DR_EXPORT app_pc vb_get_creation_pc(void *vb_heap_ptr_opaque);

DR_EXPORT app_pc vb_get_dangling_pc(void *vb_heap_ptr_opaque);

DR_EXPORT app_pc vb_get_creation_ret_pc(void *vb_heap_ptr_opaque);

DR_EXPORT app_pc vb_get_dangle_ret_pc(void *vb_heap_ptr_opaque);

DR_EXPORT bool vb_is_live(void *vb_heap_ptr_opaque);

DR_EXPORT size_t vb_get_object_size(void *vb_heap_ptr_opaque);

DR_EXPORT void *vb_get_taint_bunny();

#endif /* VULNERABILITY_BUNNY_H_ */
