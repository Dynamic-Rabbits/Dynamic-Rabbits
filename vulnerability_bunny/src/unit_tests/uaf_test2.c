/*
 * uaf_test2.c
 *
 *      Author: john
 */

#include <wchar.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void printLine(const char * line)

{

	if (line != NULL)

	{

		printf("%s\n", line);

	}

}

void CWE416_Use_After_Free__malloc_free_char_01_bad()

{

	char * data;

	data = NULL;

	data = (char *) malloc(100 * sizeof(char));

	if (data == NULL) {
		exit(-1);
	}
	memset(data, 'A', 100 - 1);

	data[100 - 1] = '\0';

	free(data);

	printLine(data);

}

int main(int argc, char * argv[])

{

	printLine("Calling bad()...");

	CWE416_Use_After_Free__malloc_free_char_01_bad();

	printLine("Finished bad()");

	return 0;

}

